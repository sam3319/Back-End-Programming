## JSP에서 쿠키(Cookie)란?

쿠키는 웹 브라우저(클라이언트)에 저장되는 작은 데이터 조각으로, 서버와 클라이언트가 정보를 주고받을 때 사용자의 상태나 정보를 임시로 저장하는 데 사용된다. 예를 들어, 자동 로그인, 아이디 저장, 사용자 맞춤 페이지 제공, "하루 동안 보지 않기" 같은 기능을 구현할 때 활용된다.

HTTP 프로토콜의 비연결성(Connectionless)과 비상태성(Stateless) 특성 때문에, 사용자가 여러 번 요청을 보내더라도 서버는 이전 상태를 기억하지 못한다. 쿠키를 사용하면 이런 상태 정보를 클라이언트에 저장해 두었다가, 다음 요청 시 서버가 해당 정보를 활용할 수 있다.

---

## 쿠키의 동작 원리

1. **쿠키 생성**: 서버(JSP)에서 쿠키 객체를 생성하고 응답(response)에 담아 브라우저로 전송한다.
2. **쿠키 저장**: 브라우저는 받은 쿠키를 자체 저장소(메모리나 파일)에 저장한다.
3. **쿠키 전송**: 이후 같은 사이트에 요청이 있을 때마다 브라우저는 저장된 쿠키를 서버로 함께 전송한다.
4. **쿠키 활용**: 서버는 전송받은 쿠키를 이용해 사용자를 식별하거나 맞춤형 서비스를 제공한다.

---

## 쿠키의 주요 구성 요소

- **이름(Name)**: 쿠키를 구분하는 식별자
- **값(Value)**: 저장할 데이터(문자열)
- **유효시간(MaxAge)**: 쿠키가 유지되는 시간(초 단위, 0이면 즉시 삭제)
- **도메인(Domain)**: 쿠키가 적용될 도메인
- **경로(Path)**: 쿠키가 적용될 URL 경로

---

## JSP에서 쿠키 사용법

**1. 쿠키 생성 및 저장**

```jsp
&lt;%
Cookie cookie = new Cookie("userId", "apple"); // 이름, 값 지정
cookie.setMaxAge(60 * 60 * 24); // 유효기간 1일(초 단위)
cookie.setPath("/"); // 모든 경로에서 사용
response.addCookie(cookie); // 응답에 쿠키 추가
%&gt;
```

- 쿠키 값에 한글, 특수문자 등을 저장할 때는 반드시 인코딩(URLEncoder.encode) 처리가 필요하다.

**2. 쿠키 읽기**

```jsp
&lt;%
Cookie[] cookies = request.getCookies();
if (cookies != null) {
    for (Cookie c : cookies) {
        if ("userId".equals(c.getName())) {
            String value = c.getValue();
            // value 사용
        }
    }
}
%&gt;
```

- 모든 쿠키는 배열로 반환되며, 원하는 이름의 쿠키를 찾아서 값을 꺼내 쓴다.

**3. 쿠키 수정**

- 같은 이름의 쿠키를 새로 생성해서 `response.addCookie()`로 보내면 기존 쿠키가 덮어써진다.

**4. 쿠키 삭제**

```jsp
&lt;%
Cookie cookie = new Cookie("userId", "");
cookie.setMaxAge(0); // 유효기간 0초로 설정
response.addCookie(cookie);
%&gt;
```

- 유효기간을 0으로 설정해 응답에 추가하면 해당 쿠키가 삭제된다.

---

## 쿠키와 세션의 차이

| 쿠키(Cookie) | 세션(Session) |
| :-- | :-- |
| 클라이언트(브라우저)에 저장 | 서버에 저장 |
| 텍스트(문자열) 데이터만 저장 | 객체 등 다양한 데이터 저장 |
| 보안에 취약 | 상대적으로 보안이 강함 |
| 1개당 4KB, 도메인당 20개 제한 | 서버 용량만큼 저장 가능 |
| 비교적 빠름 | 서버 부하로 느릴 수 있음 |


---

## 실전 예시

**관심 직업을 쿠키로 저장하는 JSP 예시**:

1. 사용자가 selectPage.jsp에서 직업을 선택해 personalPage.jsp로 전송
2. personalPage.jsp에서 선택한 값을 쿠키로 생성, 유효기간 6개월 설정
3. homepage.jsp에서 쿠키를 읽어 맞춤형 정보를 제공

---

## 정리

- 쿠키는 클라이언트에 저장되는 작은 데이터로, 사용자의 상태나 정보를 유지하는 데 사용된다.
- JSP에서는 `Cookie` 객체를 생성해 응답에 추가하고, 요청에서 쿠키 배열을 받아 사용할 수 있다.
- 쿠키 값은 문자열만 저장 가능하며, 보안상 민감한 정보는 저장하지 않는 것이 좋다.
- 쿠키는 세션과 달리 클라이언트에 저장되므로 서버 부하가 적지만, 보안에 취약하다.
